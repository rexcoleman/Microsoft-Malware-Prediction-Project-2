# src/data/metadata.py

import yaml
import os
import pandas as pd
from src.analysis.univariate_analysis import create_comparison_table

def load_metadata(metadata_path='config/feature_metadata.yaml'):
    """Load metadata from a YAML file."""
    with open(metadata_path, 'r') as file:
        metadata = yaml.safe_load(file)
    return metadata

def create_or_load_comparison_table(train_sample, metadata, comparison_table_path):
    """Create or load the comparison table for feature classification."""
    if not os.path.exists(comparison_table_path):
        comparison_table = create_comparison_table(train_sample, metadata)
        comparison_table.to_csv(comparison_table_path, index=False)
        print("\nManual review file created.")
    else:
        print("\nManual review file already exists. Skipping creation.")
        comparison_table = pd.read_csv(comparison_table_path)
    
    return comparison_table

