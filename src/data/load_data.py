# src/data/load_data.py

import pandas as pd
from src.config_loader import load_paths
from sklearn.model_selection import train_test_split

# def load_sample_data(nrows=None, stratify_col=None):
#     paths = load_paths()
#     full_train = pd.read_csv(paths['data']['raw_train'], low_memory=False)
    
#     # Stratify sampling if specified
#     if stratify_col and nrows:
#         train_sample, _ = train_test_split(full_train, train_size=nrows, stratify=full_train[stratify_col], random_state=42)
#     else:
#         train_sample = full_train.sample(n=nrows, random_state=42) if nrows else full_train

#     test_sample = pd.read_csv(paths['data']['raw_test'], nrows=nrows, low_memory=False)
#     return train_sample, test_sample


# src/data/load_data.py

import pandas as pd
from src.config_loader import load_paths

def load_sample_data(nrows=None):
    paths = load_paths()
    train_sample = pd.read_csv(paths['data']['raw_train'], nrows=nrows, low_memory=False)
    test_sample = pd.read_csv(paths['data']['raw_test'], nrows=nrows, low_memory=False)
    return train_sample, test_sample




# def load_sample_data(nrows=None):
#     paths = load_paths()
#     train_sample = pd.read_csv(paths['data']['raw_train'], nrows=nrows, low_memory=False)
#     test_sample = pd.read_csv(paths['data']['raw_test'], nrows=nrows, low_memory=False)
#     return train_sample, test_sample

def detect_mixed_types(df):
    mixed_type_columns = []
    for column in df.columns:
        unique_types = df[column].apply(type).unique()
        if len(unique_types) > 1:
            mixed_type_columns.append((column, unique_types))
    return mixed_type_columns

def clean_mixed_types(df, mixed_type_columns):
    for column, types in mixed_type_columns:
        df[column] = df[column].astype(str).replace('nan', 'Unknown')
    return df

def load_data(file_path, dtype_spec=None):
    return pd.read_csv(file_path, dtype=dtype_spec, low_memory=False)








# # src/data/load_data.py

# import pandas as pd
# from src.config_loader import load_paths

# def load_sample_data(nrows=10000):
#     paths = load_paths()
#     train_sample = pd.read_csv(paths['data']['raw_train'], nrows=nrows)
#     test_sample = pd.read_csv(paths['data']['raw_test'], nrows=nrows)
#     return train_sample, test_sample
