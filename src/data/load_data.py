# src/data/load_data.py

import pandas as pd
from tqdm import tqdm

def load_data(file_path, nrows=None):
    """
    Load data from a CSV file with a progress bar.

    Parameters:
    - file_path (str): The path to the CSV file.
    - nrows (int): Number of rows to read. Reads all rows if None.

    Returns:
    - DataFrame: Loaded data.
    """
    # Use chunksize to load data in chunks with a progress bar
    chunksize = 10000
    chunks = []
    with pd.read_csv(file_path, chunksize=chunksize, nrows=nrows) as reader:
        for chunk in tqdm(reader, desc=f"Loading {file_path}"):
            chunks.append(chunk)
    return pd.concat(chunks, ignore_index=True)

def sample_data(df, n_samples=10000, random_state=42):
    """
    Sample the dataframe.

    Parameters:
    - df (DataFrame): The dataframe to sample from.
    - n_samples (int): The number of samples to draw.
    - random_state (int): Random seed for reproducibility.

    Returns:
    - DataFrame: Sampled data.
    """
    return df.sample(n=n_samples, random_state=random_state)

