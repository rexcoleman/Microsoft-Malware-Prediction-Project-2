import os
import pandas as pd
from visualization.visualize import plot_histogram, plot_boxplot, plot_countplot, plot_scatter, plot_boxplot_comparison

def univariate_analysis(df, output_dir):
    for col in df.columns:
        if df[col].dtype in ['int64', 'float64']:
            plot_histogram(df, col, output_dir)
            plot_boxplot(df, col, output_dir)
        else:
            plot_countplot(df, col, output_dir)

def bivariate_analysis(df, target, output_dir):
    numerical_features = df.select_dtypes(include=['int64', 'float64']).columns.tolist()
    
    for feature in numerical_features:
        if feature != target:
            plot_scatter(df, feature, target, output_dir)
            plot_boxplot_comparison(df, target, feature, output_dir)

def calculate_statistics(df, output_dir):
    stats = df.describe().transpose()
    stats['skew'] = df.skew()
    stats['kurt'] = df.kurt()
    
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    stats.to_csv(f'{output_dir}/central_tendency_dispersion.csv')
    return stats
