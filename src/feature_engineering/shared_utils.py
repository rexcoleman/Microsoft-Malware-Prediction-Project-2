# src/feature_engineering/shared_utils.py

import pandas as pd
import logging
from typing import List

def extract_missing_percentage(metadata: dict, feature: str) -> float:
    """
    Extract the missing percentage for a given feature from the metadata.
    """
    return metadata['features'][feature]['missing_values'].get('percentage', 0.0)

def should_label_missing(missing_percentage: float, threshold: float = 5.0) -> bool:
    """
    Determine whether missing values for a feature should be labeled based on the threshold.
    """
    return missing_percentage > threshold

