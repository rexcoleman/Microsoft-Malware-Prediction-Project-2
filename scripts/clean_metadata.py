import yaml

def load_yaml(file_path):
    with open(file_path, 'r') as file:
        return yaml.safe_load(file)

def save_yaml(data, file_path):
    with open(file_path, 'w') as file:
        yaml.safe_dump(data, file)

def remove_redundant_fields(metadata):
    for feature in metadata['features'].values():
        feature.pop('skewness', None)
        feature.pop('kurtosis', None)
        feature.pop('outliers', None)
    return metadata

# Load metadata
metadata_path = 'config/feature_metadata.yaml'
metadata = load_yaml(metadata_path)

# Remove redundant fields
updated_metadata = remove_redundant_fields(metadata)

# Save updated metadata
save_yaml(updated_metadata, metadata_path)

print("Redundant fields removed and feature metadata updated.")

